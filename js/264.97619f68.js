"use strict";(self["webpackChunkvue01"]=self["webpackChunkvue01"]||[]).push([[264],{908:function(t,e,a){a.d(e,{A:function(){return r}});var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"right-button-group"},[t.isShowZhongYangButton?e("el-button",{staticClass:"long-btn2",class:{active:"中央空调"===t.selectedButton},attrs:{type:"primary"},on:{click:t.handleZhongYangClick}},[e("i",{staticClass:"el-icon-office-building"}),t._v(" 中央空调 ")]):t._e(),t.isShowDeviceInfoButton?e("el-button",{staticClass:"long-btn",class:{active:"设备信息"===t.selectedButton},attrs:{type:"primary"},on:{click:t.handleDeviceInfoClick}},[e("i",{staticClass:"el-icon-info"}),t._v(" 设备信息 ")]):t._e(),t.isDataRelatedButton?e("el-button",{staticClass:"long-btn3",class:{active:"数据总览"===t.selectedButton},attrs:{type:"primary"},on:{click:t.handleDataOverviewClick}},[e("i",{staticClass:"el-icon-data-analysis"}),t._v(" 数据总览 ")]):t._e(),t.isDataRelatedButton?e("el-button",{staticClass:"long-btn4",class:{active:"用电计量"===t.selectedButton},attrs:{type:"primary"},on:{click:t.handleElectricityMeterClick}},[e("i",{staticClass:"el-icon-lightning"}),t._v(" 用电计量 ")]):t._e(),t.isDataRelatedButton?e("el-button",{staticClass:"long-btn5",class:{active:"用水计量"===t.selectedButton},attrs:{type:"primary"},on:{click:t.handleWaterMeterClick}},[e("i",{staticClass:"el-icon-watermelon"}),t._v(" 用水计量 ")]):t._e(),t.isGJButton?e("el-button",{staticClass:"long-btn6",class:{active:"告警级别"===t.selectedButton},attrs:{type:"primary"},on:{click:t.handleAlarmLevelClick}},[e("i",{staticClass:"el-icon-bell"}),t._v(" 告警级别 ")]):t._e(),t.isGJButton?e("el-button",{staticClass:"long-btn7",class:{active:"告警规则"===t.selectedButton},attrs:{type:"primary"},on:{click:t.handleAlarmRuleClick}},[e("i",{staticClass:"el-icon-setting"}),t._v(" 告警规则 ")]):t._e(),t.isGJButton?e("el-button",{staticClass:"long-btn8",class:{active:"告警处理"===t.selectedButton},attrs:{type:"primary"},on:{click:t.handleAlarmHandleClick}},[e("i",{staticClass:"el-icon-edit"}),t._v(" 告警处理 ")]):t._e(),t.isZhiNengQuanXianButton?e("el-button",{staticClass:"long-btn10",class:{active:"智能控制"===t.selectedButton},attrs:{type:"primary"},on:{click:t.handleZhiNengClick}},[e("i",{staticClass:"el-icon-cpu"}),t._v(" 智能控制 ")]):t._e(),t.isZhiNengQuanXianButton?e("el-button",{staticClass:"long-btn9",class:{active:"权限控制"===t.selectedButton},attrs:{type:"primary"},on:{click:t.handleQuanXianClick}},[e("i",{staticClass:"el-icon-lock"}),t._v(" 权限控制 ")]):t._e()],1)},s=[],i=(a(4114),{data(){return{localSelectedButton:this.selectedButton}},computed:{isShowDeviceInfoButton(){return["GongZuoTai","zhongyangkongtiao"].includes(this.$route.name)},isShowZhongYangButton(){return["GongZuoTai","zhongyangkongtiao"].includes(this.$route.name)},isDataRelatedButton(){return["shujuzonglan","yongshuijiliang","yongdianjiliang"].includes(this.$route.name)},isGJButton(){return["gaojingjibie","gaojingguize","gaojingchuli"].includes(this.$route.name)},isZhiNengQuanXianButton(){return["zhinengkongzhi","quanxianguanli"].includes(this.$route.name)},selectedButton:{get(){return this.localSelectedButton},set(t){this.localSelectedButton=t,this.$emit("update:selectedButton",t)}}},mounted(){this.updateSelectedButtonByRoute()},watch:{"$route.name":function(){this.updateSelectedButtonByRoute()}},methods:{fetchData(){console.log("正在获取数据...")},updateSelectedButtonByRoute(){const t={GongZuoTai:"设备信息",zhongyangkongtiao:"中央空调",shujuzonglan:"数据总览",yongdianjiliang:"用电计量",yongshuijiliang:"用水计量",gaojingjibie:"告警级别",gaojingguize:"告警规则",gaojingchuli:"告警处理",quanxianguanli:"权限控制",zhinengkongzhi:"智能控制"};t[this.$route.name]&&(this.selectedButton=t[this.$route.name])},handleZhongYangClick(){this.selectedButton="中央空调","zhongyangkongtiao"!==this.$route.name&&this.$router.push({name:"zhongyangkongtiao"}),this.$emit("zhong-yang-click")},handleDeviceInfoClick(){this.selectedButton="设备信息",this.fetchData(),"GongZuoTai"!==this.$route.name&&this.$router.push({name:"GongZuoTai"}),this.$emit("device-info-click")},handleDataOverviewClick(){this.selectedButton="数据总览","shujuzonglan"!==this.$route.name&&this.$router.push({name:"shujuzonglan"})},handleElectricityMeterClick(){this.selectedButton="用电计量","yongdianjiliang"!==this.$route.name&&this.$router.push({name:"yongdianjiliang"})},handleWaterMeterClick(){this.selectedButton="用水计量","yongshuijiliang"!==this.$route.name&&this.$router.push({name:"yongshuijiliang"})},handleAlarmLevelClick(){this.selectedButton="告警级别","gaojingjibie"!==this.$route.name&&this.$router.push({name:"gaojingjibie"})},handleAlarmRuleClick(){this.selectedButton="告警规则","gaojingguize"!==this.$route.name&&this.$router.push({name:"gaojingguize"})},handleAlarmHandleClick(){this.selectedButton="告警处理","gaojingchuli"!==this.$route.name&&this.$router.push({name:"gaojingchuli"})},handleQuanXianClick(){this.selectedButton="权限控制","quanxianguanli"!==this.$route.name&&this.$router.push({name:"quanxianguanli"})},handleZhiNengClick(){this.selectedButton="智能控制","zhinengkongzhi"!==this.$route.name&&this.$router.push({name:"zhinengkongzhi"})}}}),l=i,o=a(1656),c=(0,o.A)(l,n,s,!1,null,"6b84d5f1",null),r=c.exports},4451:function(t,e,a){t.exports=a.p+"img/楼宇.10d304fd.png"},6264:function(t,e,a){a.r(e),a.d(e,{default:function(){return d}});var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"main"},[t._m(0),e("div",{staticClass:"left1"},[e("div",{staticClass:"left-top"},[e("img",{staticClass:"card-icon",attrs:{src:a(6407),alt:"楼宇图标"}}),e("span",{staticClass:"icon-text"},[t._v("数据总览")]),e("div",{staticClass:"info-list"},[e("div",{staticClass:"data-item"},[e("span",{staticClass:"label"},[t._v("总用电量:")]),e("span",{staticClass:"value"},[t._v(t._s(t.AllElc))]),e("span",{staticClass:"unit"},[t._v("kWh")])]),e("div",{staticClass:"data-item"},[e("span",{staticClass:"label"},[t._v("照明用电:")]),e("span",{staticClass:"value"},[t._v(t._s(t.ZMElc))]),e("span",{staticClass:"unit"},[t._v("kWh")])]),e("div",{staticClass:"data-item"},[e("span",{staticClass:"label"},[t._v("动力用电:")]),e("span",{staticClass:"value"},[t._v(t._s(t.DLElc))]),e("span",{staticClass:"unit"},[t._v("kWh")])])])]),e("div",{staticClass:"left-bot"},[e("img",{staticClass:"card-icon",attrs:{src:a(6407),alt:"楼宇图标"}}),e("span",{staticClass:"icon-text"},[t._v(" 楼宇信息")]),e("el-tree",{staticClass:"building-tree",attrs:{data:t.buildingTreeData,props:t.defaultProps,"node-key":"id","default-expand-all":""},on:{"node-click":t.handleNodeClick},scopedSlots:t._u([{key:"default",fn:function({node:a,data:n}){return[e("div",{staticClass:"custom-tree-node",class:`node-${n.type}`},[e("i",{staticClass:"tree-node-icon",class:t.getNodeIcon(n.type)}),e("span",{staticClass:"tree-node-label"},[t._v(t._s(a.label))]),n.meterId?e("span",{staticClass:"tree-node-id"},[t._v(t._s(n.meterId))]):t._e(),n.status?e("span",{class:["tree-node-status",n.status]},[t._v(t._s(n.status))]):t._e()])]}}])})],1)]),e("right-button-group",{model:{value:t.selectedButton,callback:function(e){t.selectedButton=e},expression:"selectedButton"}}),t.showPopup?e("div",{staticClass:"popup-div"},[e("div",{staticClass:"popup-content"},[e("div",{staticClass:"popup-header"},[e("span",{staticClass:"popup-title"},[t._v("电表信息")]),e("div",{staticClass:"chart-controls"},[e("div",{staticClass:"time-dimension"},t._l(t.timeDimensions,function(a){return e("span",{key:a.value,class:["dimension-item",{active:t.currentTimeDimension===a.value}],on:{click:function(e){return t.changeTimeDimension(a.value)}}},[t._v(" "+t._s(a.label)+" ")])}),0),e("div",{staticClass:"time-selector"},["day"===t.currentTimeDimension?e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedDate,expression:"selectedDate"}],staticClass:"date-input",attrs:{type:"date"},domProps:{value:t.selectedDate},on:{change:t.updateChartData,input:function(e){e.target.composing||(t.selectedDate=e.target.value)}}}):"month"===t.currentTimeDimension?e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedMonth,expression:"selectedMonth"}],staticClass:"date-input",attrs:{type:"month"},domProps:{value:t.selectedMonth},on:{change:t.updateChartData,input:function(e){e.target.composing||(t.selectedMonth=e.target.value)}}}):"year"===t.currentTimeDimension?e("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedYear,expression:"selectedYear"}],staticClass:"date-input year-input",attrs:{type:"number",min:"2000",max:"2030"},domProps:{value:t.selectedYear},on:{change:t.updateChartData,input:function(e){e.target.composing||(t.selectedYear=e.target.value)}}}):t._e()])])]),e("div",{ref:"popupChart",staticClass:"chart-container"}),e("button",{on:{click:t.closePopup}},[t._v("关闭")])])]):t._e()],1)},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"image-center"},[e("img",{staticClass:"center-img",attrs:{src:a(4451),alt:"楼宇图片"}})])}],i=(a(4114),a(8111),a(7588),a(1701),a(908)),l=a(8497),o={components:{RightButtonGroup:i.A},data(){const t=new Date;return{showPopup:!1,chartInstance:null,selectedMeterStatus:"",selectedMeterId:"",selectedMeterLabel:"",selectedButton:"用电计量",AllElc:465465,ZMElc:16516,DLElc:6546,timeDimensions:[{label:"日",value:"day"},{label:"月",value:"month"},{label:"年",value:"year"}],currentTimeDimension:"day",selectedDate:this.formatDate(t),selectedMonth:`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`,selectedYear:t.getFullYear(),backendData:[{id:1,name:"楼宇一",type:"building",parentId:null},{id:2,name:"低压配电室",type:"room",parentId:1},{id:6,name:"空调机房",type:"room",parentId:1},{id:8,name:"水泵房",type:"room",parentId:1},{id:3,name:"电表1",type:"meter",parentId:2,meterId:"M001",status:"正常"},{id:4,name:"电表2",type:"meter",parentId:2,meterId:"M002",status:"正常"},{id:5,name:"电表3",type:"meter",parentId:2,meterId:"M003",status:"故障"},{id:7,name:"电表4",type:"meter",parentId:6,meterId:"M004",status:"正常"},{id:9,name:"电表5",type:"meter",parentId:8,meterId:"M005",status:"正常"},{id:10,name:"电表6",type:"meter",parentId:8,meterId:"M006",status:"正常"}],buildingTreeData:[],defaultProps:{children:"children",label:"label"}}},mounted(){this.buildTreeFromBackendData()},methods:{formatDate(t){const e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${e}-${a}-${n}`},changeTimeDimension(t){this.currentTimeDimension=t,this.updateChartData()},updateChartData(){if(!this.chartInstance)return;let t=[],e=[];switch(this.currentTimeDimension){case"day":t=Array.from({length:24},(t,e)=>`${e}时`),e=Array.from({length:24},()=>Math.floor(100*Math.random()));break;case"month":const[a,n]=this.selectedMonth.split("-").map(Number),s=new Date(a,n,0).getDate();t=Array.from({length:s},(t,e)=>`${e+1}日`),e=Array.from({length:s},()=>Math.floor(500*Math.random()));break;case"year":t=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],e=Array.from({length:12},()=>Math.floor(2e3*Math.random()));break}const a={xAxis:{data:t},series:[{data:e}]};this.chartInstance.setOption(a)},handleNodeClick(t){console.log("点击节点:",t),console.log("选中电表:",t.label,"电表ID:",t.meterId),this.selectedMeterId=t.meterId,this.selectedMeterLabel=t.label,this.selectedMeterStatus=t.status,this.showPopup=!0,this.$nextTick(()=>{this.initPopupChart()})},initPopupChart(){this.chartInstance&&this.chartInstance.dispose(),this.chartInstance=l.Ts(this.$refs.popupChart);const t={title:{text:`${this.selectedMeterLabel} 用电数据`,textStyle:{color:"#fff"}},tooltip:{trigger:"axis"},xAxis:{type:"category",data:[],axisLabel:{color:"#fff"}},yAxis:{type:"value",axisLabel:{color:"#fff"}},series:[{data:[],type:"bar",itemStyle:{color:"#409EFF"}}]};this.chartInstance.setOption(t),this.updateChartData()},closePopup(){this.showPopup=!1,this.chartInstance&&(this.chartInstance.dispose(),this.chartInstance=null)},buildTreeFromBackendData(){const t={};this.backendData.forEach(e=>{t[e.id]={...e,label:e.name,children:[]}});const e=[];this.backendData.forEach(a=>{const n=t[a.id];null===a.parentId?e.push(n):t[a.parentId]&&t[a.parentId].children.push(n)}),this.buildingTreeData=e},getNodeIcon(t){const e={building:"el-icon-office-building",room:"el-icon-school",meter:"el-icon-monitor"};return e[t]||"el-icon-folder"}}},c=o,r=a(1656),u=(0,r.A)(c,n,s,!1,null,"8667f858",null),d=u.exports},6407:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAO1JREFUSIntVcERwjAMkzkG6CbtCB0BNmAFJmjZoBuUEdiEsgkbiE/KhSRunBwPHuiuD1uObMdNAvyRgWgEyQOAtlL3ISK3XAJWigMAREQAYG+IvRRqD6YoOhSKR+t2hgVdYI8kB80ursThpFWYs5MzIDkFrplkKyJnxDMpmxHJq1+5+1bMhvXp2ZFsSN4d/yTZe1zvfHQxjceFM1ETLJ54l+A7P4kmuJVgRRORn12GgiPJ0ZxAE7fGhfzmOQj3tzZGrcziy9mWuygH2zmo7SCnE3WQ2k+rL4X3e2D5g0qQeg+OAKIDVonlSzo/gBcXO4SUHIYpiwAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=264.97619f68.js.map