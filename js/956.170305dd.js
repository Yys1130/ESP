"use strict";(self["webpackChunkvue01"]=self["webpackChunkvue01"]||[]).push([[956],{908:function(e,s,t){t.d(s,{A:function(){return c}});var i=function(){var e=this,s=e._self._c;return s("div",{staticClass:"right-button-group"},[e.isShowZhongYangButton?s("el-button",{staticClass:"long-btn2",class:{active:"中央空调"===e.selectedButton},attrs:{type:"primary"},on:{click:e.handleZhongYangClick}},[s("i",{staticClass:"el-icon-office-building"}),e._v(" 中央空调 ")]):e._e(),e.isShowDeviceInfoButton?s("el-button",{staticClass:"long-btn",class:{active:"设备信息"===e.selectedButton},attrs:{type:"primary"},on:{click:e.handleDeviceInfoClick}},[s("i",{staticClass:"el-icon-info"}),e._v(" 设备信息 ")]):e._e(),e.isDataRelatedButton?s("el-button",{staticClass:"long-btn3",class:{active:"数据总览"===e.selectedButton},attrs:{type:"primary"},on:{click:e.handleDataOverviewClick}},[s("i",{staticClass:"el-icon-data-analysis"}),e._v(" 数据总览 ")]):e._e(),e.isDataRelatedButton?s("el-button",{staticClass:"long-btn4",class:{active:"用电计量"===e.selectedButton},attrs:{type:"primary"},on:{click:e.handleElectricityMeterClick}},[s("i",{staticClass:"el-icon-lightning"}),e._v(" 用电计量 ")]):e._e(),e.isDataRelatedButton?s("el-button",{staticClass:"long-btn5",class:{active:"用水计量"===e.selectedButton},attrs:{type:"primary"},on:{click:e.handleWaterMeterClick}},[s("i",{staticClass:"el-icon-watermelon"}),e._v(" 用水计量 ")]):e._e(),e.isGJButton?s("el-button",{staticClass:"long-btn6",class:{active:"告警级别"===e.selectedButton},attrs:{type:"primary"},on:{click:e.handleAlarmLevelClick}},[s("i",{staticClass:"el-icon-bell"}),e._v(" 告警级别 ")]):e._e(),e.isGJButton?s("el-button",{staticClass:"long-btn7",class:{active:"告警规则"===e.selectedButton},attrs:{type:"primary"},on:{click:e.handleAlarmRuleClick}},[s("i",{staticClass:"el-icon-setting"}),e._v(" 告警规则 ")]):e._e(),e.isGJButton?s("el-button",{staticClass:"long-btn8",class:{active:"告警处理"===e.selectedButton},attrs:{type:"primary"},on:{click:e.handleAlarmHandleClick}},[s("i",{staticClass:"el-icon-edit"}),e._v(" 告警处理 ")]):e._e(),e.isZhiNengQuanXianButton?s("el-button",{staticClass:"long-btn10",class:{active:"智能控制"===e.selectedButton},attrs:{type:"primary"},on:{click:e.handleZhiNengClick}},[s("i",{staticClass:"el-icon-cpu"}),e._v(" 智能控制 ")]):e._e(),e.isZhiNengQuanXianButton?s("el-button",{staticClass:"long-btn9",class:{active:"权限控制"===e.selectedButton},attrs:{type:"primary"},on:{click:e.handleQuanXianClick}},[s("i",{staticClass:"el-icon-lock"}),e._v(" 权限控制 ")]):e._e()],1)},a=[],n=(t(4114),{data(){return{localSelectedButton:this.selectedButton}},computed:{isShowDeviceInfoButton(){return["GongZuoTai","zhongyangkongtiao"].includes(this.$route.name)},isShowZhongYangButton(){return["GongZuoTai","zhongyangkongtiao"].includes(this.$route.name)},isDataRelatedButton(){return["shujuzonglan","yongshuijiliang","yongdianjiliang"].includes(this.$route.name)},isGJButton(){return["gaojingjibie","gaojingguize","gaojingchuli"].includes(this.$route.name)},isZhiNengQuanXianButton(){return["zhinengkongzhi","quanxianguanli"].includes(this.$route.name)},selectedButton:{get(){return this.localSelectedButton},set(e){this.localSelectedButton=e,this.$emit("update:selectedButton",e)}}},mounted(){this.updateSelectedButtonByRoute()},watch:{"$route.name":function(){this.updateSelectedButtonByRoute()}},methods:{fetchData(){console.log("正在获取数据...")},updateSelectedButtonByRoute(){const e={GongZuoTai:"设备信息",zhongyangkongtiao:"中央空调",shujuzonglan:"数据总览",yongdianjiliang:"用电计量",yongshuijiliang:"用水计量",gaojingjibie:"告警级别",gaojingguize:"告警规则",gaojingchuli:"告警处理",quanxianguanli:"权限控制",zhinengkongzhi:"智能控制"};e[this.$route.name]&&(this.selectedButton=e[this.$route.name])},handleZhongYangClick(){this.selectedButton="中央空调","zhongyangkongtiao"!==this.$route.name&&this.$router.push({name:"zhongyangkongtiao"}),this.$emit("zhong-yang-click")},handleDeviceInfoClick(){this.selectedButton="设备信息",this.fetchData(),"GongZuoTai"!==this.$route.name&&this.$router.push({name:"GongZuoTai"}),this.$emit("device-info-click")},handleDataOverviewClick(){this.selectedButton="数据总览","shujuzonglan"!==this.$route.name&&this.$router.push({name:"shujuzonglan"})},handleElectricityMeterClick(){this.selectedButton="用电计量","yongdianjiliang"!==this.$route.name&&this.$router.push({name:"yongdianjiliang"})},handleWaterMeterClick(){this.selectedButton="用水计量","yongshuijiliang"!==this.$route.name&&this.$router.push({name:"yongshuijiliang"})},handleAlarmLevelClick(){this.selectedButton="告警级别","gaojingjibie"!==this.$route.name&&this.$router.push({name:"gaojingjibie"})},handleAlarmRuleClick(){this.selectedButton="告警规则","gaojingguize"!==this.$route.name&&this.$router.push({name:"gaojingguize"})},handleAlarmHandleClick(){this.selectedButton="告警处理","gaojingchuli"!==this.$route.name&&this.$router.push({name:"gaojingchuli"})},handleQuanXianClick(){this.selectedButton="权限控制","quanxianguanli"!==this.$route.name&&this.$router.push({name:"quanxianguanli"})},handleZhiNengClick(){this.selectedButton="智能控制","zhinengkongzhi"!==this.$route.name&&this.$router.push({name:"zhinengkongzhi"})}}}),l=n,r=t(1656),o=(0,r.A)(l,i,a,!1,null,"6b84d5f1",null),c=o.exports},9956:function(e,s,t){t.r(s),t.d(s,{default:function(){return u}});var i=function(){var e=this,s=e._self._c;return s("div",{staticClass:"permission-management tech-main"},[s("div",{staticClass:"content-container tech-grid"},[s("div",{staticClass:"user-list-section tech-card"},[s("div",{staticClass:"section-header tech-header"},[s("h3",[e._v("用户列表")]),s("el-button",{staticClass:"tech-button",attrs:{type:"primary",size:"small"},on:{click:e.addUser}},[s("i",{staticClass:"el-icon-plus"}),e._v(" 添加用户 ")])],1),s("div",{staticClass:"table-container"},[s("el-table",{staticClass:"tech-table",staticStyle:{width:"100%"},attrs:{data:e.users,"highlight-current-row":""},on:{"current-change":e.handleUserSelect}},[s("el-table-column",{attrs:{prop:"id",label:"用户ID",width:"80","class-name":"tech-table-cell"}}),s("el-table-column",{attrs:{prop:"username",label:"用户名","class-name":"tech-table-cell"}}),s("el-table-column",{attrs:{prop:"role",label:"角色","class-name":"tech-table-cell"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{staticClass:"tech-tag",attrs:{type:"admin"===t.row.role?"danger":"primary"}},[e._v(" "+e._s("admin"===t.row.role?"管理员":"普通用户")+" ")])]}}])}),s("el-table-column",{attrs:{label:"操作",width:"150","class-name":"tech-table-cell"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"action-buttons"},[s("el-button",{staticClass:"tech-button-mini",attrs:{size:"mini"},on:{click:function(s){return s.stopPropagation(),e.editUser(t.row)}}},[e._v(" 编辑 ")]),s("el-button",{staticClass:"tech-button-mini danger",attrs:{size:"mini",type:"danger",disabled:"admin"===t.row.role&&"admin"===t.row.username},on:{click:function(s){return s.stopPropagation(),e.deleteUser(t.row)}}},[e._v(" 删除 ")])],1)]}}])})],1)],1)]),e.showAddUserForm?s("div",{staticClass:"add-user-section tech-card"},[s("div",{staticClass:"section-header tech-header"},[s("h3",[e._v("添加用户")]),s("el-button",{staticClass:"tech-button success",attrs:{type:"success",size:"small"},on:{click:e.saveUser}},[e._v(" 保存用户 ")])],1),s("div",{staticClass:"user-form-content tech-content"},[s("el-form",{ref:"addUserForm",staticClass:"tech-form",attrs:{model:e.userForm,rules:e.userRules}},[s("el-form-item",{attrs:{label:"用户名",prop:"username"}},[s("el-input",{staticClass:"tech-input",attrs:{autocomplete:"off"},model:{value:e.userForm.username,callback:function(s){e.$set(e.userForm,"username",s)},expression:"userForm.username"}})],1),s("el-form-item",{attrs:{label:"角色",prop:"role"}},[s("el-select",{staticClass:"tech-select",attrs:{placeholder:"请选择角色"},on:{change:e.handleRoleChange},model:{value:e.userForm.role,callback:function(s){e.$set(e.userForm,"role",s)},expression:"userForm.role"}},[s("el-option",{attrs:{label:"管理员",value:"admin"}}),s("el-option",{attrs:{label:"普通用户",value:"user"}})],1)],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{staticClass:"tech-input",attrs:{type:"password",autocomplete:"new-password"},model:{value:e.userForm.password,callback:function(s){e.$set(e.userForm,"password",s)},expression:"userForm.password"}})],1),"user"===e.userForm.role?s("div",[s("h4",{staticClass:"tech-subtitle"},[e._v("楼宇访问权限")]),s("div",{staticClass:"building-permissions-container tech-building-container"},e._l(e.buildings,function(t){return s("el-checkbox",{key:t.id,staticClass:"tech-checkbox building-checkbox",attrs:{label:t.name},model:{value:e.userForm.buildingPermissions[t.id],callback:function(s){e.$set(e.userForm.buildingPermissions,t.id,s)},expression:"userForm.buildingPermissions[building.id]"}},[e._v(" "+e._s(t.name)+" ")])}),1)]):s("div",{staticClass:"admin-permissions-info tech-admin-panel"},[s("el-alert",{staticClass:"tech-alert",attrs:{title:"管理员拥有系统所有权限",type:"warning",description:"管理员可以访问所有楼栋和功能模块","show-icon":""}})],1)],1)],1)]):e.showEditUserForm&&e.editingUser?s("div",{staticClass:"edit-user-section tech-card"},[s("div",{staticClass:"section-header tech-header"},[s("h3",[e._v("编辑用户")]),s("el-button",{staticClass:"tech-button success",attrs:{type:"success",size:"small"},on:{click:e.saveUser}},[e._v(" 更新用户 ")])],1),s("div",{staticClass:"user-form-content tech-content"},[s("el-form",{ref:"editUserForm",staticClass:"tech-form",attrs:{model:e.userForm,rules:e.userRules}},[s("el-form-item",{attrs:{label:"用户名",prop:"username"}},[s("el-input",{staticClass:"tech-input",attrs:{autocomplete:"off"},model:{value:e.userForm.username,callback:function(s){e.$set(e.userForm,"username",s)},expression:"userForm.username"}})],1),s("el-form-item",{attrs:{label:"角色",prop:"role"}},[s("el-select",{staticClass:"tech-select",attrs:{placeholder:"请选择角色"},on:{change:e.handleRoleChange},model:{value:e.userForm.role,callback:function(s){e.$set(e.userForm,"role",s)},expression:"userForm.role"}},[s("el-option",{attrs:{label:"管理员",value:"admin"}}),s("el-option",{attrs:{label:"普通用户",value:"user"}})],1)],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{staticClass:"tech-input",attrs:{type:"password",placeholder:"留空则不修改密码",autocomplete:"new-password"},model:{value:e.userForm.password,callback:function(s){e.$set(e.userForm,"password",s)},expression:"userForm.password"}})],1),"user"===e.userForm.role?s("div",[s("h4",{staticClass:"tech-subtitle"},[e._v("楼宇访问权限")]),s("div",{staticClass:"building-permissions-container tech-building-container"},e._l(e.buildings,function(t){return s("el-checkbox",{key:t.id,staticClass:"tech-checkbox building-checkbox",attrs:{label:t.name},model:{value:e.userForm.buildingPermissions[t.id],callback:function(s){e.$set(e.userForm.buildingPermissions,t.id,s)},expression:"userForm.buildingPermissions[building.id]"}},[e._v(" "+e._s(t.name)+" ")])}),1)]):s("div",{staticClass:"admin-permissions-info tech-admin-panel"},[s("el-alert",{staticClass:"tech-alert",attrs:{title:"管理员拥有系统所有权限",type:"warning",description:"管理员可以访问所有楼栋和功能模块","show-icon":""}})],1)],1)],1)]):e.showUserDetail&&e.selectedUser?s("div",{staticClass:"user-detail-section tech-card"},[s("div",{staticClass:"section-header tech-header"},[s("h3",[e._v(e._s(e.selectedUser.username)+" 的详细信息")])]),s("div",{staticClass:"user-detail-content tech-content"},[s("div",{staticClass:"user-info-item"},[s("span",{staticClass:"label"},[e._v("用户ID:")]),s("span",{staticClass:"value"},[e._v(e._s(e.selectedUser.id))])]),s("div",{staticClass:"user-info-item"},[s("span",{staticClass:"label"},[e._v("用户名:")]),s("span",{staticClass:"value"},[e._v(e._s(e.selectedUser.username))])]),s("div",{staticClass:"user-info-item"},[s("span",{staticClass:"label"},[e._v("角色:")]),s("span",{staticClass:"value"},[s("el-tag",{staticClass:"tech-tag",attrs:{type:"admin"===e.selectedUser.role?"danger":"primary"}},[e._v(" "+e._s("admin"===e.selectedUser.role?"管理员":"普通用户")+" ")])],1)]),"admin"!==e.selectedUser.role?s("div",{staticClass:"building-permissions-info"},[s("h4",{staticClass:"tech-subtitle"},[e._v("楼栋访问权限")]),s("div",{staticClass:"building-permissions-container tech-building-container"},e._l(e.buildings,function(t){return s("div",{key:t.id,staticClass:"building-item"},[s("span",{staticClass:"building-name"},[e._v(e._s(t.name)+":")]),s("el-tag",{staticClass:"permission-tag",attrs:{type:e.selectedUser.buildingPermissions[t.id]?"success":"info"}},[e._v(" "+e._s(e.selectedUser.buildingPermissions[t.id]?"允许访问":"禁止访问")+" ")])],1)}),0)]):s("div",{staticClass:"admin-permissions-info tech-admin-panel"},[s("el-alert",{staticClass:"tech-alert",attrs:{title:"管理员拥有系统所有权限",type:"warning",description:"管理员可以访问所有楼栋和功能模块","show-icon":""}}),s("div",{staticClass:"admin-building-list"},[s("h4",{staticClass:"tech-subtitle"},[e._v("可访问的楼栋")]),s("div",{staticClass:"building-tags"},e._l(e.buildings,function(t){return s("el-tag",{key:t.id,staticClass:"tech-tag building-tag",attrs:{type:"success",effect:"dark"}},[e._v(" "+e._s(t.name)+" ")])}),1)])],1)])]):e.showPermissionSettings&&e.selectedUser?s("div",{staticClass:"permission-section tech-card"},[s("div",{staticClass:"section-header tech-header"},[s("h3",[e._v(e._s(e.selectedUser.username)+" 的权限设置")]),s("el-button",{staticClass:"tech-button success",attrs:{type:"success",size:"small",loading:e.saving},on:{click:e.savePermissions}},[e._v(" 保存权限 ")])],1),s("div",{staticClass:"permission-content tech-content"},[s("div",{staticClass:"role-info tech-role-info"},[s("el-tag",{staticClass:"tech-tag",attrs:{type:"admin"===e.selectedUser.role?"danger":"primary"}},[e._v(" "+e._s("admin"===e.selectedUser.role?"管理员 - 拥有所有权限":"普通用户")+" ")])],1),"admin"!==e.selectedUser.role?s("div",{staticClass:"building-permissions"},[s("h4",{staticClass:"tech-subtitle"},[e._v("楼栋访问权限")]),s("div",{staticClass:"building-permissions-container tech-building-container"},e._l(e.buildings,function(t){return s("el-checkbox",{key:t.id,staticClass:"tech-checkbox building-checkbox",attrs:{label:t.name,disabled:"admin"===e.selectedUser.role},model:{value:e.selectedUser.buildingPermissions[t.id],callback:function(s){e.$set(e.selectedUser.buildingPermissions,t.id,s)},expression:"selectedUser.buildingPermissions[building.id]"}},[e._v(" "+e._s(t.name)+" ")])}),1)]):s("div",{staticClass:"admin-permissions tech-admin-panel"},[s("el-alert",{staticClass:"tech-alert",attrs:{title:"管理员拥有系统所有权限",type:"warning",description:"管理员可以访问所有楼栋和功能模块","show-icon":""}}),s("div",{staticClass:"admin-building-list"},[s("h4",{staticClass:"tech-subtitle"},[e._v("可访问的楼栋")]),s("div",{staticClass:"building-tags"},e._l(e.buildings,function(t){return s("el-tag",{key:t.id,staticClass:"tech-tag building-tag",attrs:{type:"success",effect:"dark"}},[e._v(" "+e._s(t.name)+" ")])}),1)])],1)])]):s("div",{staticClass:"no-selection tech-card"},[s("el-alert",{staticClass:"tech-alert",attrs:{title:"请选择一个用户进行权限设置",type:"info",description:"从左侧用户列表中选择一个用户来管理其权限","show-icon":""}})],1)]),s("right-button-group")],1)},a=[],n=(t(4114),t(8111),t(7588),t(908)),l={components:{RightButtonGroup:n.A},name:"Quanxianguanli",data(){return{selectedButton:"权限管理",users:[{id:1,username:"admin",role:"admin",buildingPermissions:{}},{id:2,username:"用户一",role:"user",buildingPermissions:{"building-a":!0,"building-b":!0,"building-c":!1,"building-d":!1}},{id:3,username:"用户二",role:"user",buildingPermissions:{"building-a":!1,"building-b":!1,"building-c":!0,"building-d":!0}}],buildings:[{id:"building-a",name:"楼栋A"},{id:"building-b",name:"楼栋B"},{id:"building-c",name:"楼栋C"},{id:"building-d",name:"楼栋D"},{id:"building-e",name:"楼栋E"}],selectedUser:null,showAddUserForm:!1,showEditUserForm:!1,showUserDetail:!1,showPermissionSettings:!0,editingUser:null,saving:!1,userForm:{username:"",role:"user",password:"",buildingPermissions:{}},userRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},mounted(){this.users.length>0&&(this.selectedUser={...this.users[0]})},methods:{handleUserSelect(e){e&&(this.selectedUser=JSON.parse(JSON.stringify(e)),this.showUserDetail=!0,this.showAddUserForm=!1,this.showEditUserForm=!1,this.showPermissionSettings=!1)},addUser(){this.showAddUserForm=!0,this.showEditUserForm=!1,this.showUserDetail=!1,this.showPermissionSettings=!1,this.editingUser=null,this.userForm={username:"",role:"user",password:"",buildingPermissions:{}},this.buildings.forEach(e=>{this.$set(this.userForm.buildingPermissions,e.id,!1)}),this.$nextTick(()=>{this.$refs.addUserForm&&this.$refs.addUserForm.clearValidate()})},editUser(e){this.showAddUserForm=!1,this.showEditUserForm=!0,this.showUserDetail=!1,this.showPermissionSettings=!1,this.editingUser=e,this.userForm={username:e.username,role:e.role,password:"",buildingPermissions:"user"===e.role?{...e.buildingPermissions}:{}},this.$nextTick(()=>{this.$refs.editUserForm&&this.$refs.editUserForm.clearValidate()})},handleRoleChange(e){"user"!==e||this.userForm.buildingPermissions||(this.$set(this,"userForm.buildingPermissions",{}),this.buildings.forEach(e=>{this.$set(this.userForm.buildingPermissions,e.id,!1)}))},saveUser(){let e=this.editingUser?this.$refs.editUserForm:this.$refs.addUserForm;e.validate(e=>{if(e){if(this.editingUser){const e=this.users.findIndex(e=>e.id===this.editingUser.id);-1!==e&&(this.users[e].username=this.userForm.username,this.users[e].role=this.userForm.role,"user"===this.userForm.role?this.users[e].buildingPermissions={...this.userForm.buildingPermissions}:this.users[e].buildingPermissions={}),this.$message.success("用户更新成功")}else{const e={id:Date.now(),username:this.userForm.username,role:this.userForm.role,buildingPermissions:{}};"user"===this.userForm.role&&(e.buildingPermissions={...this.userForm.buildingPermissions}),this.users.push(e),this.$message.success("用户添加成功")}this.showAddUserForm=!1,this.showEditUserForm=!1,this.showUserDetail=!0,this.showPermissionSettings=!1}})},deleteUser(e){"admin"!==e.username?this.$confirm(`确定要删除用户 "${e.username}" 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const s=this.users.findIndex(s=>s.id===e.id);-1!==s&&(this.users.splice(s,1),this.selectedUser&&this.selectedUser.id===e.id&&(this.selectedUser=this.users.length>0?{...this.users[0]}:null),this.$message.success("用户删除成功"))}).catch(()=>{}):this.$message.warning("不能删除管理员账户")},savePermissions(){this.selectedUser&&(this.saving=!0,setTimeout(()=>{const e=this.users.findIndex(e=>e.id===this.selectedUser.id);-1!==e&&(this.users[e]={...this.selectedUser}),this.saving=!1,this.$message.success("权限保存成功")},800))}}},r=l,o=t(1656),c=(0,o.A)(r,i,a,!1,null,"ee71fb7a",null),u=c.exports}}]);
//# sourceMappingURL=956.170305dd.js.map